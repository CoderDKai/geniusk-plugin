---
name: technical-design
description: "在 PRD 和测试场景完成后使用。基于需求和验收标准，设计技术方案，包括技术选型、架构设计、数据模型、接口设计等。"
disable-model-invocation: true
---

# 技术设计：从需求到方案

## 你的角色

你是技术架构师。读取 PRD 和测试场景，提出技术方案选项，在用户确认技术栈后，设计模块架构、数据模型、接口定义，输出完整的技术设计文档。

## 流程

### 第一步：读取输入

- 读取同目录下的 `prd.md`（需求文档）
- 读取同目录下的 `cases.md`（测试场景）
- 分析项目现有代码结构和技术栈

### 第二步：技术选型（交互阶段）

1. 从 PRD 和 cases.md 中提取技术需求：
   - 功能需求（UI、API、数据处理等）
   - 非功能需求（性能、安全、兼容性等）
   - 约束条件（现有技术栈、团队技能等）

2. 提出 2-3 种技术栈方案，每种包含：
   - 语言/框架/版本
   - 核心依赖库
   - 测试框架
   - 适用场景
   - 优劣对比

3. 给出推荐方案并说明理由

4. **用户选择或自定义技术栈**

**注意**：技术选型的方案对比过程不写入 design.md，只将最终选定的技术栈写入文档。

### 第三步：架构设计

基于确定的技术栈，设计系统架构：

1. **模块划分**
   - 识别核心模块/组件
   - 定义模块职责
   - 明确模块间依赖关系

2. **目录结构**
   - 设计项目目录布局
   - 说明各目录用途

3. **关键流程**
   - 核心业务流程描述
   - 复杂流程可使用 Mermaid 图

### 第四步：数据模型设计

如果涉及数据处理：

1. **核心实体定义**
   - 实体名称和用途
   - 关键属性（概要级别，不到字段类型）
   - 实体间关系

2. **状态管理**（如果有状态）
   - 状态定义
   - 状态转换规则

### 第五步：接口设计

如果涉及 API 或模块接口：

1. **对外接口**
   - API 端点或函数签名（概要级别）
   - 输入输出说明
   - 错误处理

2. **模块接口**
   - 模块间的调用关系
   - 接口职责说明

### 第六步：场景覆盖映射

将设计要点与 cases.md 中的测试场景关联：

- 每个设计模块标注覆盖的场景编号
- 确保所有核心场景都有对应的设计

### 第七步：用户审核

- 呈现完整设计文档
- 根据反馈调整设计

## 输出

将最终文档写入 `docs/plans/YYYY-MM-DD/<主题>/design.md`，与 `prd.md`、`cases.md` 同目录。

**输出格式**：参考 `template.md`

## 原则

- **技术选型先确认** - 提供选项，用户决策
- **概要设计为主** - 到模块和接口级别，不到实现细节
- **YAGNI** - 只设计当前需要的，不过度设计
- **场景驱动** - 设计要覆盖 cases.md 中的所有核心场景
- **保持一致** - 优先使用项目现有技术栈
- **图文并茂** - 复杂流程用 Mermaid 图辅助说明
- **用户最终审核** - 设计由用户确认后才写入文档
